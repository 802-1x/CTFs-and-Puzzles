Name: JaWT Scratchpad
Points: 400
Category: Web Exploitation
Problem Statement: Check the admin scratchpad! https://jupiter.challenges.picoctf.org/problem/61864/ or http://jupiter.challenges.picoctf.org:61864

My Process / Solution

1) Inspecting the page shows nothing of interest except a reference to John the Ripper down the bottom.
2) The authentication prompt allows us to log in with any username except admin. A basic SQL Injection of admin' lets us in as the admin account. No flag.
3) Inspecting the page now that we are authenticated as admin reveals a cookie called 'jwt'. Stored in this cookie is a sequence of characters, appearing to be seperated into three sections.
4) 'jwt' is a JSON Web Token that comprises of three components: the header, the payload and the signature. Decoding the cookie through jwt.io reveals that the header uses the HS256 algorithm.
5) Using John the Ripper, we get ilovepic.
6) We then change the username John to admin and resign the token with the ilovepic key.
7) Inserting the new JSON token into the cookie allows us to reload the page to reveal the flag.

Flag: picoCTF{jawt_was_just_what_you_thought_1ca14548}
